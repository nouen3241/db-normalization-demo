<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ­£è¦åŒ–ãƒ‡ãƒ¢</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        
        .section h2 {
            color: #34495e;
            margin-top: 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background-color: white;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .checklist {
            margin: 20px 0;
        }
        
        .checklist label {
            display: block;
            margin: 10px 0;
            padding: 10px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .checklist label:hover {
            background-color: #e8f4fd;
        }
        
        .checklist input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .result.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .result.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .result.warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .copy-button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }
        
        .copy-button:hover {
            background-color: #218838;
        }
        
        .copy-button.copied {
            background-color: #6f42c1;
        }
        
        .query-section {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .query-header {
            background-color: #f8f9fa;
            padding: 10px 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .query-content {
            padding: 0;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .explanation {
            background-color: #e8f4fd;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ­£è¦åŒ–ãƒ»ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«</h1>
        
        <div class="section">
            <h2>ã‚µãƒ³ãƒ—ãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«: ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¯¾è±¡ãƒ‡ãƒ¼ã‚¿</h2>
            <table id="sampleTable">
                <thead>
                    <tr>
                        <th>æ³¨æ–‡ID</th>
                        <th>é¡§å®¢å</th>
                        <th>é¡§å®¢é›»è©±</th>
                        <th>é¡§å®¢ä½æ‰€</th>
                        <th>å•†å“å</th>
                        <th>å•†å“ã‚«ãƒ†ã‚´ãƒª</th>
                        <th>ä¾¡æ ¼</th>
                        <th>æ•°é‡</th>
                        <th>æ³¨æ–‡æ—¥</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>ç”°ä¸­å¤ªéƒ</td>
                        <td>090-1234-5678</td>
                        <td>æ±äº¬éƒ½æ¸‹è°·åŒºã€€</td>
                        <td>ãƒãƒ¼ãƒˆPC</td>
                        <td>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿</td>
                        <td>80000</td>
                        <td>1</td>
                        <td>24/01/15</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>ç”°ä¸­ã€€å¤ªéƒ</td>
                        <td>09012345678</td>
                        <td>æ±äº¬éƒ½æ¸‹è°·åŒº</td>
                        <td>ãƒã‚¦ã‚¹</td>
                        <td>PCå‘¨è¾ºæ©Ÿå™¨</td>
                        <td>2000</td>
                        <td>2</td>
                        <td>2024-1-15</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>ä½è—¤èŠ±å­</td>
                        <td>080-9876-5432</td>
                        <td>å¤§é˜ªåºœå¤§é˜ªå¸‚</td>
                        <td>keyboard</td>
                        <td>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼</td>
                        <td></td>
                        <td>1</td>
                        <td>2024/01/16</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>SATOU HANAKO</td>
                        <td>080-9876-5432</td>
                        <td>å¤§é˜ªåºœå¤§é˜ªå¸‚ </td>
                        <td>æ¶²æ™¶ãƒ¢ãƒ‹ã‚¿ãƒ¼</td>
                        <td>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿</td>
                        <td>25000</td>
                        <td>1</td>
                        <td>2024-01-16</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>ç”°ä¸­å¤ªéƒ</td>
                        <td>090-1234-5678</td>
                        <td>æ±äº¬éƒ½æ¸‹è°·åŒºã€€</td>
                        <td>ãƒãƒ¼ãƒˆPC</td>
                        <td>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿</td>
                        <td>80000</td>
                        <td>1</td>
                        <td>24/01/15</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>å±±ç”° ä¸‰éƒ</td>
                        <td>NULL</td>
                        <td></td>
                        <td>SSD</td>
                        <td>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</td>
                        <td>15000.0</td>
                        <td>2</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="section">
            <h2>ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»æ­£è¦åŒ–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h2>
            <div class="explanation">
                ä»¥ä¸‹ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‹ã‚‰å®Ÿè¡Œã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‡¦ç†ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
                é¸æŠã—ãŸé …ç›®ã«å¯¾å¿œã™ã‚‹SQLï¼ˆBigQuery/SQLiteï¼‰ã‚¯ã‚¨ãƒªãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚
            </div>
            
            <div class="checklist">
                <label>
                    <input type="checkbox" id="check1" value="duplicate_data">
                    é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡ºãƒ»å‰Šé™¤
                </label>
                
                <label>
                    <input type="checkbox" id="check2" value="whitespace_cleanup">
                    ç©ºç™½æ–‡å­—ã®çµ±ä¸€ï¼ˆå…ˆé ­ãƒ»æœ«å°¾ã®ç©ºç™½é™¤å»ã€å…¨è§’â†’åŠè§’ï¼‰
                </label>
                
                <label>
                    <input type="checkbox" id="check3" value="case_normalization">
                    å¤§æ–‡å­—ãƒ»å°æ–‡å­—ã®çµ±ä¸€
                </label>
                
                <label>
                    <input type="checkbox" id="check4" value="null_empty_check">
                    NULLå€¤ãƒ»ç©ºæ–‡å­—åˆ—ã®æ¤œå‡º
                </label>
                
                <label>
                    <input type="checkbox" id="check5" value="date_format_standardization">
                    æ—¥ä»˜å½¢å¼ã®çµ±ä¸€
                </label>
                
                <label>
                    <input type="checkbox" id="check6" value="phone_format_standardization">
                    é›»è©±ç•ªå·å½¢å¼ã®çµ±ä¸€
                </label>
                
                <label>
                    <input type="checkbox" id="check7" value="category_standardization">
                    ã‚«ãƒ†ã‚´ãƒªè¡¨è¨˜ã‚†ã‚Œã®çµ±ä¸€
                </label>
                
                <label>
                    <input type="checkbox" id="check8" value="data_type_validation">
                    ãƒ‡ãƒ¼ã‚¿å‹ã®æ¤œè¨¼ï¼ˆæ•°å€¤ã€æ—¥ä»˜ç­‰ï¼‰
                </label>
                
                <label>
                    <input type="checkbox" id="check9" value="length_validation">
                    æ–‡å­—æ•°åˆ¶é™ã®ãƒã‚§ãƒƒã‚¯
                </label>
                
                <label>
                    <input type="checkbox" id="check10" value="special_char_check">
                    ç‰¹æ®Šæ–‡å­—ãƒ»ç•°å¸¸æ–‡å­—ã®æ¤œå‡º
                </label>
            </div>
            
            <div style="margin: 20px 0;">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">ãƒ†ãƒ¼ãƒ–ãƒ«åè¨­å®š:</label>
                    <input type="text" id="tableName" placeholder="ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å…¥åŠ› (ä¾‹: orders)" value="orders" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 200px;">
                    <small style="color: #666; display: block; margin-top: 5px;">BigQueryã®å ´åˆ: `project.dataset.table` å½¢å¼ã§å…¥åŠ›å¯èƒ½</small>
                </div>
                
                <div>
                    <label>
                        <input type="radio" name="sql_type" value="bigquery" checked>
                        BigQuery
                    </label>
                    <label style="margin-left: 20px;">
                        <input type="radio" name="sql_type" value="sqlite">
                        SQLite
                    </label>
                </div>
            </div>
            
            <button onclick="generateSQL()">SQLã‚¯ã‚¨ãƒªç”Ÿæˆ</button>
            <button onclick="resetChecks()">ãƒªã‚»ãƒƒãƒˆ</button>
            
            <div id="result" class="result" style="display: none;"></div>
        </div>
        
        <div class="section" id="sqlOutput" style="display: none;">
            <h2>ç”Ÿæˆã•ã‚ŒãŸSQLã‚¯ã‚¨ãƒª</h2>
            <div id="generatedQueries"></div>
        </div>
    </div>

    <script>
        const sqlQueries = {
            duplicate_data: {
                bigquery: {
                    title: "é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡ºãƒ»å‰Šé™¤",
                    description: "å®Œå…¨ã«ä¸€è‡´ã™ã‚‹é‡è¤‡è¡Œã‚’æ¤œå‡ºã—ã€å‰Šé™¤ã™ã‚‹",
                    detection: `-- é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡º
SELECT 
  é¡§å®¢å, é¡§å®¢é›»è©±, é¡§å®¢ä½æ‰€, å•†å“å, å•†å“ã‚«ãƒ†ã‚´ãƒª, ä¾¡æ ¼, æ•°é‡, æ³¨æ–‡æ—¥,
  COUNT(*) as duplicate_count
FROM \`your_project.your_dataset.orders\`
GROUP BY é¡§å®¢å, é¡§å®¢é›»è©±, é¡§å®¢ä½æ‰€, å•†å“å, å•†å“ã‚«ãƒ†ã‚´ãƒª, ä¾¡æ ¼, æ•°é‡, æ³¨æ–‡æ—¥
HAVING COUNT(*) > 1;`,
                    cleanup: `-- é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ï¼ˆæœ€æ–°ã®æ³¨æ–‡IDã‚’æ®‹ã™ï¼‰
DELETE FROM \`your_project.your_dataset.orders\`
WHERE æ³¨æ–‡ID NOT IN (
  SELECT MAX(æ³¨æ–‡ID)
  FROM \`your_project.your_dataset.orders\`
  GROUP BY é¡§å®¢å, é¡§å®¢é›»è©±, é¡§å®¢ä½æ‰€, å•†å“å, å•†å“ã‚«ãƒ†ã‚´ãƒª, ä¾¡æ ¼, æ•°é‡, æ³¨æ–‡æ—¥
);`
                },
                sqlite: {
                    title: "é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡ºãƒ»å‰Šé™¤",
                    description: "å®Œå…¨ã«ä¸€è‡´ã™ã‚‹é‡è¤‡è¡Œã‚’æ¤œå‡ºã—ã€å‰Šé™¤ã™ã‚‹",
                    detection: `-- é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡º
SELECT 
  é¡§å®¢å, é¡§å®¢é›»è©±, é¡§å®¢ä½æ‰€, å•†å“å, å•†å“ã‚«ãƒ†ã‚´ãƒª, ä¾¡æ ¼, æ•°é‡, æ³¨æ–‡æ—¥,
  COUNT(*) as duplicate_count
FROM orders
GROUP BY é¡§å®¢å, é¡§å®¢é›»è©±, é¡§å®¢ä½æ‰€, å•†å“å, å•†å“ã‚«ãƒ†ã‚´ãƒª, ä¾¡æ ¼, æ•°é‡, æ³¨æ–‡æ—¥
HAVING COUNT(*) > 1;`,
                    cleanup: `-- é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ï¼ˆROWIDã‚’ä½¿ç”¨ï¼‰
DELETE FROM orders 
WHERE ROWID NOT IN (
  SELECT MIN(ROWID)
  FROM orders
  GROUP BY é¡§å®¢å, é¡§å®¢é›»è©±, é¡§å®¢ä½æ‰€, å•†å“å, å•†å“ã‚«ãƒ†ã‚´ãƒª, ä¾¡æ ¼, æ•°é‡, æ³¨æ–‡æ—¥
);`
                }
            },
            whitespace_cleanup: {
                bigquery: {
                    title: "ç©ºç™½æ–‡å­—ã®çµ±ä¸€",
                    description: "å…ˆé ­ãƒ»æœ«å°¾ã®ç©ºç™½é™¤å»ã€å…¨è§’â†’åŠè§’å¤‰æ›",
                    detection: `-- ç©ºç™½æ–‡å­—ã®å•é¡Œã‚’æ¤œå‡º
SELECT æ³¨æ–‡ID, é¡§å®¢å, é¡§å®¢ä½æ‰€,
  CASE 
    WHEN é¡§å®¢å != TRIM(é¡§å®¢å) THEN 'å…ˆé ­æœ«å°¾ã«ç©ºç™½'
    WHEN é¡§å®¢ä½æ‰€ != TRIM(é¡§å®¢ä½æ‰€) THEN 'å…ˆé ­æœ«å°¾ã«ç©ºç™½'
    WHEN REGEXP_CONTAINS(é¡§å®¢å, r'[ã€€\\s]{2,}') THEN 'é€£ç¶šç©ºç™½'
    ELSE 'OK'
  END as whitespace_issue
FROM \`your_project.your_dataset.orders\`
WHERE é¡§å®¢å != TRIM(é¡§å®¢å) 
   OR é¡§å®¢ä½æ‰€ != TRIM(é¡§å®¢ä½æ‰€)
   OR REGEXP_CONTAINS(é¡§å®¢å, r'[ã€€\\s]{2,}');`,
                    cleanup: `-- ç©ºç™½æ–‡å­—ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
UPDATE \`your_project.your_dataset.orders\`
SET 
  é¡§å®¢å = TRIM(REGEXP_REPLACE(é¡§å®¢å, r'[ã€€\\s]+', ' ')),
  é¡§å®¢ä½æ‰€ = TRIM(REGEXP_REPLACE(é¡§å®¢ä½æ‰€, r'[ã€€\\s]+', ' ')),
  å•†å“å = TRIM(REGEXP_REPLACE(å•†å“å, r'[ã€€\\s]+', ' '))
WHERE TRUE;`
                },
                sqlite: {
                    title: "ç©ºç™½æ–‡å­—ã®çµ±ä¸€",
                    description: "å…ˆé ­ãƒ»æœ«å°¾ã®ç©ºç™½é™¤å»",
                    detection: `-- ç©ºç™½æ–‡å­—ã®å•é¡Œã‚’æ¤œå‡º
SELECT æ³¨æ–‡ID, é¡§å®¢å, é¡§å®¢ä½æ‰€,
  CASE 
    WHEN é¡§å®¢å != TRIM(é¡§å®¢å) THEN 'å…ˆé ­æœ«å°¾ã«ç©ºç™½'
    WHEN é¡§å®¢ä½æ‰€ != TRIM(é¡§å®¢ä½æ‰€) THEN 'å…ˆé ­æœ«å°¾ã«ç©ºç™½'
    ELSE 'OK'
  END as whitespace_issue
FROM orders
WHERE é¡§å®¢å != TRIM(é¡§å®¢å) 
   OR é¡§å®¢ä½æ‰€ != TRIM(é¡§å®¢ä½æ‰€);`,
                    cleanup: `-- ç©ºç™½æ–‡å­—ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
UPDATE orders
SET 
  é¡§å®¢å = TRIM(é¡§å®¢å),
  é¡§å®¢ä½æ‰€ = TRIM(é¡§å®¢ä½æ‰€),
  å•†å“å = TRIM(å•†å“å);`
                }
            },
            case_normalization: {
                bigquery: {
                    title: "å¤§æ–‡å­—ãƒ»å°æ–‡å­—ã®çµ±ä¸€",
                    description: "æ–‡å­—ã®å¤§å°çµ±ä¸€ï¼ˆå…¨ã¦å°æ–‡å­—ã«å¤‰æ›ï¼‰",
                    detection: `-- å¤§æ–‡å­—å°æ–‡å­—ã®ä¸çµ±ä¸€ã‚’æ¤œå‡º
SELECT æ³¨æ–‡ID, é¡§å®¢å, å•†å“å,
  CASE 
    WHEN é¡§å®¢å != LOWER(é¡§å®¢å) THEN 'å¤§æ–‡å­—å«ã‚€'
    WHEN å•†å“å != LOWER(å•†å“å) THEN 'å¤§æ–‡å­—å«ã‚€'
    ELSE 'OK'
  END as case_issue
FROM \`your_project.your_dataset.orders\`
WHERE é¡§å®¢å != LOWER(é¡§å®¢å) OR å•†å“å != LOWER(å•†å“å);`,
                    cleanup: `-- å¤§æ–‡å­—å°æ–‡å­—ã®çµ±ä¸€
UPDATE \`your_project.your_dataset.orders\`
SET 
  é¡§å®¢å = LOWER(é¡§å®¢å),
  å•†å“å = LOWER(å•†å“å)
WHERE TRUE;`
                },
                sqlite: {
                    title: "å¤§æ–‡å­—ãƒ»å°æ–‡å­—ã®çµ±ä¸€",
                    description: "æ–‡å­—ã®å¤§å°çµ±ä¸€ï¼ˆå…¨ã¦å°æ–‡å­—ã«å¤‰æ›ï¼‰",
                    detection: `-- å¤§æ–‡å­—å°æ–‡å­—ã®ä¸çµ±ä¸€ã‚’æ¤œå‡º
SELECT æ³¨æ–‡ID, é¡§å®¢å, å•†å“å,
  CASE 
    WHEN é¡§å®¢å != LOWER(é¡§å®¢å) THEN 'å¤§æ–‡å­—å«ã‚€'
    WHEN å•†å“å != LOWER(å•†å“å) THEN 'å¤§æ–‡å­—å«ã‚€'
    ELSE 'OK'
  END as case_issue
FROM orders
WHERE é¡§å®¢å != LOWER(é¡§å®¢å) OR å•†å“å != LOWER(å•†å“å);`,
                    cleanup: `-- å¤§æ–‡å­—å°æ–‡å­—ã®çµ±ä¸€
UPDATE orders
SET 
  é¡§å®¢å = LOWER(é¡§å®¢å),
  å•†å“å = LOWER(å•†å“å);`
                }
            },
            null_empty_check: {
                bigquery: {
                    title: "NULLå€¤ãƒ»ç©ºæ–‡å­—åˆ—ã®æ¤œå‡º",
                    description: "NULLå€¤ã‚„ç©ºæ–‡å­—åˆ—ã‚’æ¤œå‡º",
                    detection: `-- NULLå€¤ãƒ»ç©ºæ–‡å­—åˆ—ã®æ¤œå‡º
SELECT æ³¨æ–‡ID,
  CASE 
    WHEN é¡§å®¢å IS NULL OR é¡§å®¢å = '' THEN 'é¡§å®¢åãŒNULL/ç©º'
    WHEN é¡§å®¢é›»è©± IS NULL OR é¡§å®¢é›»è©± = '' OR é¡§å®¢é›»è©± = 'NULL' THEN 'é›»è©±ç•ªå·ãŒNULL/ç©º'
    WHEN é¡§å®¢ä½æ‰€ IS NULL OR é¡§å®¢ä½æ‰€ = '' THEN 'ä½æ‰€ãŒNULL/ç©º'
    WHEN å•†å“å IS NULL OR å•†å“å = '' THEN 'å•†å“åãŒNULL/ç©º'
    WHEN ä¾¡æ ¼ IS NULL OR ä¾¡æ ¼ = '' THEN 'ä¾¡æ ¼ãŒNULL/ç©º'
    WHEN æ³¨æ–‡æ—¥ IS NULL OR æ³¨æ–‡æ—¥ = '' THEN 'æ³¨æ–‡æ—¥ãŒNULL/ç©º'
    ELSE 'OK'
  END as null_issue
FROM \`your_project.your_dataset.orders\`
WHERE é¡§å®¢å IS NULL OR é¡§å®¢å = ''
   OR é¡§å®¢é›»è©± IS NULL OR é¡§å®¢é›»è©± = '' OR é¡§å®¢é›»è©± = 'NULL'
   OR é¡§å®¢ä½æ‰€ IS NULL OR é¡§å®¢ä½æ‰€ = ''
   OR å•†å“å IS NULL OR å•†å“å = ''
   OR ä¾¡æ ¼ IS NULL OR ä¾¡æ ¼ = ''
   OR æ³¨æ–‡æ—¥ IS NULL OR æ³¨æ–‡æ—¥ = '';`,
                    cleanup: `-- NULLå€¤ãƒ»ç©ºæ–‡å­—åˆ—ã®å¯¾å‡¦ä¾‹
UPDATE \`your_project.your_dataset.orders\`
SET 
  é¡§å®¢é›»è©± = 'ä¸æ˜'
WHERE é¡§å®¢é›»è©± IS NULL OR é¡§å®¢é›»è©± = '' OR é¡§å®¢é›»è©± = 'NULL';`
                },
                sqlite: {
                    title: "NULLå€¤ãƒ»ç©ºæ–‡å­—åˆ—ã®æ¤œå‡º",
                    description: "NULLå€¤ã‚„ç©ºæ–‡å­—åˆ—ã‚’æ¤œå‡º",
                    detection: `-- NULLå€¤ãƒ»ç©ºæ–‡å­—åˆ—ã®æ¤œå‡º
SELECT æ³¨æ–‡ID,
  CASE 
    WHEN é¡§å®¢å IS NULL OR é¡§å®¢å = '' THEN 'é¡§å®¢åãŒNULL/ç©º'
    WHEN é¡§å®¢é›»è©± IS NULL OR é¡§å®¢é›»è©± = '' OR é¡§å®¢é›»è©± = 'NULL' THEN 'é›»è©±ç•ªå·ãŒNULL/ç©º'
    WHEN é¡§å®¢ä½æ‰€ IS NULL OR é¡§å®¢ä½æ‰€ = '' THEN 'ä½æ‰€ãŒNULL/ç©º'
    WHEN å•†å“å IS NULL OR å•†å“å = '' THEN 'å•†å“åãŒNULL/ç©º'
    WHEN ä¾¡æ ¼ IS NULL OR ä¾¡æ ¼ = '' THEN 'ä¾¡æ ¼ãŒNULL/ç©º'
    WHEN æ³¨æ–‡æ—¥ IS NULL OR æ³¨æ–‡æ—¥ = '' THEN 'æ³¨æ–‡æ—¥ãŒNULL/ç©º'
    ELSE 'OK'
  END as null_issue
FROM orders
WHERE é¡§å®¢å IS NULL OR é¡§å®¢å = ''
   OR é¡§å®¢é›»è©± IS NULL OR é¡§å®¢é›»è©± = '' OR é¡§å®¢é›»è©± = 'NULL'
   OR é¡§å®¢ä½æ‰€ IS NULL OR é¡§å®¢ä½æ‰€ = ''
   OR å•†å“å IS NULL OR å•†å“å = ''
   OR ä¾¡æ ¼ IS NULL OR ä¾¡æ ¼ = ''
   OR æ³¨æ–‡æ—¥ IS NULL OR æ³¨æ–‡æ—¥ = '';`,
                    cleanup: `-- NULLå€¤ãƒ»ç©ºæ–‡å­—åˆ—ã®å¯¾å‡¦ä¾‹
UPDATE orders
SET é¡§å®¢é›»è©± = 'ä¸æ˜'
WHERE é¡§å®¢é›»è©± IS NULL OR é¡§å®¢é›»è©± = '' OR é¡§å®¢é›»è©± = 'NULL';`
                }
            },
            date_format_standardization: {
                bigquery: {
                    title: "æ—¥ä»˜å½¢å¼ã®çµ±ä¸€",
                    description: "æ§˜ã€…ãªæ—¥ä»˜å½¢å¼ã‚’YYYY-MM-DDå½¢å¼ã«çµ±ä¸€",
                    detection: `-- æ—¥ä»˜å½¢å¼ã®ä¸çµ±ä¸€ã‚’æ¤œå‡º
SELECT æ³¨æ–‡ID, æ³¨æ–‡æ—¥,
  CASE 
    WHEN æ³¨æ–‡æ—¥ LIKE '%/%' AND LENGTH(æ³¨æ–‡æ—¥) < 10 THEN 'çŸ­ç¸®å½¢å¼'
    WHEN æ³¨æ–‡æ—¥ LIKE '%/%' THEN 'ã‚¹ãƒ©ãƒƒã‚·ãƒ¥å½¢å¼'
    WHEN æ³¨æ–‡æ—¥ LIKE '%-%' AND LENGTH(æ³¨æ–‡æ—¥) = 10 THEN 'æ¨™æº–å½¢å¼'
    WHEN æ³¨æ–‡æ—¥ = '' OR æ³¨æ–‡æ—¥ IS NULL THEN 'ç©º/NULL'
    ELSE 'ä¸æ˜å½¢å¼'
  END as date_format
FROM \`your_project.your_dataset.orders\`
WHERE æ³¨æ–‡æ—¥ IS NOT NULL AND æ³¨æ–‡æ—¥ != '';`,
                    cleanup: `-- æ—¥ä»˜å½¢å¼ã®çµ±ä¸€
UPDATE \`your_project.your_dataset.orders\`
SET æ³¨æ–‡æ—¥ = 
  CASE 
    WHEN æ³¨æ–‡æ—¥ LIKE '__/__/__' THEN CONCAT('20', SUBSTR(æ³¨æ–‡æ—¥, 1, 2), '-', LPAD(SUBSTR(æ³¨æ–‡æ—¥, 4, 2), 2, '0'), '-', LPAD(SUBSTR(æ³¨æ–‡æ—¥, 7, 2), 2, '0'))
    WHEN æ³¨æ–‡æ—¥ LIKE '____-_-__' THEN CONCAT(SUBSTR(æ³¨æ–‡æ—¥, 1, 4), '-', LPAD(SUBSTR(æ³¨æ–‡æ—¥, 6, 1), 2, '0'), '-', SUBSTR(æ³¨æ–‡æ—¥, 8, 2))
    WHEN æ³¨æ–‡æ—¥ LIKE '____/_/__' THEN REPLACE(æ³¨æ–‡æ—¥, '/', '-')
    ELSE æ³¨æ–‡æ—¥
  END
WHERE æ³¨æ–‡æ—¥ IS NOT NULL AND æ³¨æ–‡æ—¥ != '';`
                },
                sqlite: {
                    title: "æ—¥ä»˜å½¢å¼ã®çµ±ä¸€",
                    description: "æ§˜ã€…ãªæ—¥ä»˜å½¢å¼ã‚’YYYY-MM-DDå½¢å¼ã«çµ±ä¸€",
                    detection: `-- æ—¥ä»˜å½¢å¼ã®ä¸çµ±ä¸€ã‚’æ¤œå‡º
SELECT æ³¨æ–‡ID, æ³¨æ–‡æ—¥,
  CASE 
    WHEN æ³¨æ–‡æ—¥ LIKE '%/%' AND LENGTH(æ³¨æ–‡æ—¥) < 10 THEN 'çŸ­ç¸®å½¢å¼'
    WHEN æ³¨æ–‡æ—¥ LIKE '%/%' THEN 'ã‚¹ãƒ©ãƒƒã‚·ãƒ¥å½¢å¼'
    WHEN æ³¨æ–‡æ—¥ LIKE '%-%' AND LENGTH(æ³¨æ–‡æ—¥) = 10 THEN 'æ¨™æº–å½¢å¼'
    WHEN æ³¨æ–‡æ—¥ = '' OR æ³¨æ–‡æ—¥ IS NULL THEN 'ç©º/NULL'
    ELSE 'ä¸æ˜å½¢å¼'
  END as date_format
FROM orders
WHERE æ³¨æ–‡æ—¥ IS NOT NULL AND æ³¨æ–‡æ—¥ != '';`,
                    cleanup: `-- æ—¥ä»˜å½¢å¼ã®çµ±ä¸€
UPDATE orders
SET æ³¨æ–‡æ—¥ = 
  CASE 
    WHEN æ³¨æ–‡æ—¥ LIKE '__/__/__' THEN '20' || SUBSTR(æ³¨æ–‡æ—¥, 1, 2) || '-' || PRINTF('%02d', SUBSTR(æ³¨æ–‡æ—¥, 4, 2)) || '-' || PRINTF('%02d', SUBSTR(æ³¨æ–‡æ—¥, 7, 2))
    WHEN æ³¨æ–‡æ—¥ LIKE '____-_-__' THEN SUBSTR(æ³¨æ–‡æ—¥, 1, 4) || '-' || PRINTF('%02d', SUBSTR(æ³¨æ–‡æ—¥, 6, 1)) || '-' || SUBSTR(æ³¨æ–‡æ—¥, 8, 2)
    WHEN æ³¨æ–‡æ—¥ LIKE '____/__/__' THEN REPLACE(æ³¨æ–‡æ—¥, '/', '-')
    ELSE æ³¨æ–‡æ—¥
  END
WHERE æ³¨æ–‡æ—¥ IS NOT NULL AND æ³¨æ–‡æ—¥ != '';`
                }
            },
            phone_format_standardization: {
                bigquery: {
                    title: "é›»è©±ç•ªå·å½¢å¼ã®çµ±ä¸€",
                    description: "é›»è©±ç•ªå·ã‚’XXX-XXXX-XXXXå½¢å¼ã«çµ±ä¸€",
                    detection: `-- é›»è©±ç•ªå·å½¢å¼ã®ä¸çµ±ä¸€ã‚’æ¤œå‡º
SELECT æ³¨æ–‡ID, é¡§å®¢é›»è©±,
  CASE 
    WHEN é¡§å®¢é›»è©± LIKE '___-____-____' THEN 'æ¨™æº–å½¢å¼'
    WHEN REGEXP_CONTAINS(é¡§å®¢é›»è©±, r'^[0-9]{11}$') THEN 'ãƒã‚¤ãƒ•ãƒ³ãªã—'
    WHEN é¡§å®¢é›»è©± = 'NULL' OR é¡§å®¢é›»è©± IS NULL THEN 'NULL'
    ELSE 'ä¸æ˜å½¢å¼'
  END as phone_format
FROM \`your_project.your_dataset.orders\`
WHERE é¡§å®¢é›»è©± IS NOT NULL;`,
                    cleanup: `-- é›»è©±ç•ªå·å½¢å¼ã®çµ±ä¸€
UPDATE \`your_project.your_dataset.orders\`
SET é¡§å®¢é›»è©± = 
  CASE 
    WHEN REGEXP_CONTAINS(é¡§å®¢é›»è©±, r'^[0-9]{11}$') THEN 
      CONCAT(SUBSTR(é¡§å®¢é›»è©±, 1, 3), '-', SUBSTR(é¡§å®¢é›»è©±, 4, 4), '-', SUBSTR(é¡§å®¢é›»è©±, 8, 4))
    WHEN é¡§å®¢é›»è©± = 'NULL' THEN NULL
    ELSE é¡§å®¢é›»è©±
  END
WHERE é¡§å®¢é›»è©± IS NOT NULL;`
                },
                sqlite: {
                    title: "é›»è©±ç•ªå·å½¢å¼ã®çµ±ä¸€",
                    description: "é›»è©±ç•ªå·ã‚’XXX-XXXX-XXXXå½¢å¼ã«çµ±ä¸€",
                    detection: `-- é›»è©±ç•ªå·å½¢å¼ã®ä¸çµ±ä¸€ã‚’æ¤œå‡º
SELECT æ³¨æ–‡ID, é¡§å®¢é›»è©±,
  CASE 
    WHEN é¡§å®¢é›»è©± LIKE '___-____-____' THEN 'æ¨™æº–å½¢å¼'
    WHEN LENGTH(é¡§å®¢é›»è©±) = 11 AND é¡§å®¢é›»è©± GLOB '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]' THEN 'ãƒã‚¤ãƒ•ãƒ³ãªã—'
    WHEN é¡§å®¢é›»è©± = 'NULL' OR é¡§å®¢é›»è©± IS NULL THEN 'NULL'
    ELSE 'ä¸æ˜å½¢å¼'
  END as phone_format
FROM orders
WHERE é¡§å®¢é›»è©± IS NOT NULL;`,
                    cleanup: `-- é›»è©±ç•ªå·å½¢å¼ã®çµ±ä¸€
UPDATE orders
SET é¡§å®¢é›»è©± = 
  CASE 
    WHEN LENGTH(é¡§å®¢é›»è©±) = 11 AND é¡§å®¢é›»è©± GLOB '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]' THEN 
      SUBSTR(é¡§å®¢é›»è©±, 1, 3) || '-' || SUBSTR(é¡§å®¢é›»è©±, 4, 4) || '-' || SUBSTR(é¡§å®¢é›»è©±, 8, 4)
    WHEN é¡§å®¢é›»è©± = 'NULL' THEN NULL
    ELSE é¡§å®¢é›»è©±
  END
WHERE é¡§å®¢é›»è©± IS NOT NULL;`
                }
            },
            category_standardization: {
                bigquery: {
                    title: "ã‚«ãƒ†ã‚´ãƒªè¡¨è¨˜ã‚†ã‚Œã®çµ±ä¸€",
                    description: "ã‚«ãƒ†ã‚´ãƒªåã®è¡¨è¨˜ã‚†ã‚Œã‚’çµ±ä¸€",
                    detection: `-- ã‚«ãƒ†ã‚´ãƒªè¡¨è¨˜ã‚†ã‚Œã®æ¤œå‡º
SELECT DISTINCT å•†å“ã‚«ãƒ†ã‚´ãƒª, COUNT(*) as count
FROM \`your_project.your_dataset.orders\`
GROUP BY å•†å“ã‚«ãƒ†ã‚´ãƒª
ORDER BY å•†å“ã‚«ãƒ†ã‚´ãƒª;`,
                    cleanup: `-- ã‚«ãƒ†ã‚´ãƒªè¡¨è¨˜ã‚†ã‚Œã®çµ±ä¸€
UPDATE \`your_project.your_dataset.orders\`
SET å•†å“ã‚«ãƒ†ã‚´ãƒª = 
  CASE 
    WHEN å•†å“ã‚«ãƒ†ã‚´ãƒª IN ('ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼', 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿') THEN 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿'
    WHEN å•†å“ã‚«ãƒ†ã‚´ãƒª = 'PCå‘¨è¾ºæ©Ÿå™¨' THEN 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿'
    ELSE å•†å“ã‚«ãƒ†ã‚´ãƒª
  END
WHERE TRUE;`
                },
                sqlite: {
                    title: "ã‚«ãƒ†ã‚´ãƒªè¡¨è¨˜ã‚†ã‚Œã®çµ±ä¸€",
                    description: "ã‚«ãƒ†ã‚´ãƒªåã®è¡¨è¨˜ã‚†ã‚Œã‚’çµ±ä¸€",
                    detection: `-- ã‚«ãƒ†ã‚´ãƒªè¡¨è¨˜ã‚†ã‚Œã®æ¤œå‡º
SELECT DISTINCT å•†å“ã‚«ãƒ†ã‚´ãƒª, COUNT(*) as count
FROM orders
GROUP BY å•†å“ã‚«ãƒ†ã‚´ãƒª
ORDER BY å•†å“ã‚«ãƒ†ã‚´ãƒª;`,
                    cleanup: `-- ã‚«ãƒ†ã‚´ãƒªè¡¨è¨˜ã‚†ã‚Œã®çµ±ä¸€
UPDATE orders
SET å•†å“ã‚«ãƒ†ã‚´ãƒª = 
  CASE 
    WHEN å•†å“ã‚«ãƒ†ã‚´ãƒª IN ('ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼', 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿') THEN 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿'
    WHEN å•†å“ã‚«ãƒ†ã‚´ãƒª = 'PCå‘¨è¾ºæ©Ÿå™¨' THEN 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿'
    ELSE å•†å“ã‚«ãƒ†ã‚´ãƒª
  END;`
                }
            },
            data_type_validation: {
                bigquery: {
                    title: "ãƒ‡ãƒ¼ã‚¿å‹ã®æ¤œè¨¼",
                    description: "æ•°å€¤ã‚„æ—¥ä»˜ãªã©ã®ãƒ‡ãƒ¼ã‚¿å‹ã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯",
                    detection: `-- ãƒ‡ãƒ¼ã‚¿å‹ã®æ¤œè¨¼
SELECT æ³¨æ–‡ID, ä¾¡æ ¼, æ•°é‡,
  CASE 
    WHEN SAFE_CAST(ä¾¡æ ¼ AS INT64) IS NULL AND ä¾¡æ ¼ IS NOT NULL AND ä¾¡æ ¼ != '' THEN 'ä¾¡æ ¼ãŒæ•°å€¤ã§ãªã„'
    WHEN SAFE_CAST(æ•°é‡ AS INT64) IS NULL AND æ•°é‡ IS NOT NULL THEN 'æ•°é‡ãŒæ•°å€¤ã§ãªã„'
    WHEN SAFE_CAST(ä¾¡æ ¼ AS INT64) < 0 THEN 'ä¾¡æ ¼ãŒè² ã®å€¤'
    WHEN SAFE_CAST(æ•°é‡ AS INT64) <= 0 THEN 'æ•°é‡ãŒ0ä»¥ä¸‹'
    ELSE 'OK'
  END as data_type_issue
FROM \`your_project.your_dataset.orders\`
WHERE (SAFE_CAST(ä¾¡æ ¼ AS INT64) IS NULL AND ä¾¡æ ¼ IS NOT NULL AND ä¾¡æ ¼ != '')
   OR (SAFE_CAST(æ•°é‡ AS INT64) IS NULL AND æ•°é‡ IS NOT NULL)
   OR SAFE_CAST(ä¾¡æ ¼ AS INT64) < 0
   OR SAFE_CAST(æ•°é‡ AS INT64) <= 0;`,
                    cleanup: `-- ãƒ‡ãƒ¼ã‚¿å‹ã®å•é¡Œä¿®æ­£ä¾‹
UPDATE \`your_project.your_dataset.orders\`
SET ä¾¡æ ¼ = CAST(REGEXP_REPLACE(ä¾¡æ ¼, r'[^0-9.]', '') AS INT64)
WHERE SAFE_CAST(ä¾¡æ ¼ AS INT64) IS NULL AND ä¾¡æ ¼ IS NOT NULL AND ä¾¡æ ¼ != '';`
                },
                sqlite: {
                    title: "ãƒ‡ãƒ¼ã‚¿å‹ã®æ¤œè¨¼",
                    description: "æ•°å€¤ã‚„æ—¥ä»˜ãªã©ã®ãƒ‡ãƒ¼ã‚¿å‹ã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯",
                    detection: `-- ãƒ‡ãƒ¼ã‚¿å‹ã®æ¤œè¨¼
SELECT æ³¨æ–‡ID, ä¾¡æ ¼, æ•°é‡,
  CASE 
    WHEN ä¾¡æ ¼ != '' AND TYPEOF(CAST(ä¾¡æ ¼ AS INTEGER)) = 'integer' AND CAST(ä¾¡æ ¼ AS INTEGER) < 0 THEN 'ä¾¡æ ¼ãŒè² ã®å€¤'
    WHEN æ•°é‡ != '' AND TYPEOF(CAST(æ•°é‡ AS INTEGER)) = 'integer' AND CAST(æ•°é‡ AS INTEGER) <= 0 THEN 'æ•°é‡ãŒ0ä»¥ä¸‹'
    WHEN ä¾¡æ ¼ != '' AND TYPEOF(CAST(ä¾¡æ ¼ AS INTEGER)) != 'integer' THEN 'ä¾¡æ ¼ãŒæ•°å€¤ã§ãªã„'
    WHEN æ•°é‡ != '' AND TYPEOF(CAST(æ•°é‡ AS INTEGER)) != 'integer' THEN 'æ•°é‡ãŒæ•°å€¤ã§ãªã„'
    ELSE 'OK'
  END as data_type_issue
FROM orders
WHERE (ä¾¡æ ¼ != '' AND TYPEOF(CAST(ä¾¡æ ¼ AS INTEGER)) != 'integer')
   OR (æ•°é‡ != '' AND TYPEOF(CAST(æ•°é‡ AS INTEGER)) != 'integer')
   OR (ä¾¡æ ¼ != '' AND CAST(ä¾¡æ ¼ AS INTEGER) < 0)
   OR (æ•°é‡ != '' AND CAST(æ•°é‡ AS INTEGER) <= 0);`,
                    cleanup: `-- ãƒ‡ãƒ¼ã‚¿å‹ã®å•é¡Œä¿®æ­£ä¾‹
UPDATE orders
SET ä¾¡æ ¼ = CAST(ä¾¡æ ¼ AS INTEGER)
WHERE ä¾¡æ ¼ != '' AND TYPEOF(CAST(ä¾¡æ ¼ AS INTEGER)) = 'integer';`
                }
            },
            length_validation: {
                bigquery: {
                    title: "æ–‡å­—æ•°åˆ¶é™ã®ãƒã‚§ãƒƒã‚¯",
                    description: "å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ–‡å­—æ•°åˆ¶é™ã‚’ãƒã‚§ãƒƒã‚¯",
                    detection: `-- æ–‡å­—æ•°åˆ¶é™ã®ãƒã‚§ãƒƒã‚¯
SELECT æ³¨æ–‡ID, é¡§å®¢å, å•†å“å,
  LENGTH(é¡§å®¢å) as customer_name_length,
  LENGTH(å•†å“å) as product_name_length,
  CASE 
    WHEN LENGTH(é¡§å®¢å) > 20 THEN 'é¡§å®¢åãŒé•·ã™ãã‚‹'
    WHEN LENGTH(å•†å“å) > 50 THEN 'å•†å“åãŒé•·ã™ãã‚‹'
    WHEN LENGTH(é¡§å®¢å) < 2 THEN 'é¡§å®¢åãŒçŸ­ã™ãã‚‹'
    ELSE 'OK'
  END as length_issue
FROM \`your_project.your_dataset.orders\`
WHERE LENGTH(é¡§å®¢å) > 20 OR LENGTH(å•†å“å) > 50 OR LENGTH(é¡§å®¢å) < 2;`,
                    cleanup: `-- æ–‡å­—æ•°åˆ¶é™ã®å¯¾å‡¦ä¾‹
UPDATE \`your_project.your_dataset.orders\`
SET é¡§å®¢å = SUBSTR(é¡§å®¢å, 1, 20)
WHERE LENGTH(é¡§å®¢å) > 20;`
                },
                sqlite: {
                    title: "æ–‡å­—æ•°åˆ¶é™ã®ãƒã‚§ãƒƒã‚¯",
                    description: "å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ–‡å­—æ•°åˆ¶é™ã‚’ãƒã‚§ãƒƒã‚¯",
                    detection: `-- æ–‡å­—æ•°åˆ¶é™ã®ãƒã‚§ãƒƒã‚¯
SELECT æ³¨æ–‡ID, é¡§å®¢å, å•†å“å,
  LENGTH(é¡§å®¢å) as customer_name_length,
  LENGTH(å•†å“å) as product_name_length,
  CASE 
    WHEN LENGTH(é¡§å®¢å) > 20 THEN 'é¡§å®¢åãŒé•·ã™ãã‚‹'
    WHEN LENGTH(å•†å“å) > 50 THEN 'å•†å“åãŒé•·ã™ãã‚‹'
    WHEN LENGTH(é¡§å®¢å) < 2 THEN 'é¡§å®¢åãŒçŸ­ã™ãã‚‹'
    ELSE 'OK'
  END as length_issue
FROM orders
WHERE LENGTH(é¡§å®¢å) > 20 OR LENGTH(å•†å“å) > 50 OR LENGTH(é¡§å®¢å) < 2;`,
                    cleanup: `-- æ–‡å­—æ•°åˆ¶é™ã®å¯¾å‡¦ä¾‹
UPDATE orders
SET é¡§å®¢å = SUBSTR(é¡§å®¢å, 1, 20)
WHERE LENGTH(é¡§å®¢å) > 20;`
                }
            },
            special_char_check: {
                bigquery: {
                    title: "ç‰¹æ®Šæ–‡å­—ãƒ»ç•°å¸¸æ–‡å­—ã®æ¤œå‡º",
                    description: "åˆ¶å¾¡æ–‡å­—ã‚„æƒ³å®šå¤–ã®ç‰¹æ®Šæ–‡å­—ã‚’æ¤œå‡º",
                    detection: `-- ç‰¹æ®Šæ–‡å­—ã®æ¤œå‡º
SELECT æ³¨æ–‡ID, é¡§å®¢å, å•†å“å,
  CASE 
    WHEN REGEXP_CONTAINS(é¡§å®¢å, r'[\\x00-\\x1F\\x7F-\\x9F]') THEN 'é¡§å®¢åã«åˆ¶å¾¡æ–‡å­—'
    WHEN REGEXP_CONTAINS(å•†å“å, r'[\\x00-\\x1F\\x7F-\\x9F]') THEN 'å•†å“åã«åˆ¶å¾¡æ–‡å­—'
    WHEN REGEXP_CONTAINS(é¡§å®¢å, r'[<>\"&\\\\]') THEN 'é¡§å®¢åã«å±é™ºæ–‡å­—'
    WHEN REGEXP_CONTAINS(å•†å“å, r'[<>\"&\\\\]') THEN 'å•†å“åã«å±é™ºæ–‡å­—'
    ELSE 'OK'
  END as special_char_issue
FROM \`your_project.your_dataset.orders\`
WHERE REGEXP_CONTAINS(é¡§å®¢å, r'[\\x00-\\x1F\\x7F-\\x9F<>\"&\\\\]')
   OR REGEXP_CONTAINS(å•†å“å, r'[\\x00-\\x1F\\x7F-\\x9F<>\"&\\\\]');`,
                    cleanup: `-- ç‰¹æ®Šæ–‡å­—ã®é™¤å»
UPDATE \`your_project.your_dataset.orders\`
SET 
  é¡§å®¢å = REGEXP_REPLACE(é¡§å®¢å, r'[\\x00-\\x1F\\x7F-\\x9F<>\"&\\\\]', ''),
  å•†å“å = REGEXP_REPLACE(å•†å“å, r'[\\x00-\\x1F\\x7F-\\x9F<>\"&\\\\]', '')
WHERE TRUE;`
                },
                sqlite: {
                    title: "ç‰¹æ®Šæ–‡å­—ãƒ»ç•°å¸¸æ–‡å­—ã®æ¤œå‡º",
                    description: "æƒ³å®šå¤–ã®ç‰¹æ®Šæ–‡å­—ã‚’æ¤œå‡º",
                    detection: `-- ç‰¹æ®Šæ–‡å­—ã®æ¤œå‡ºï¼ˆç°¡æ˜“ç‰ˆï¼‰
SELECT æ³¨æ–‡ID, é¡§å®¢å, å•†å“å,
  CASE 
    WHEN é¡§å®¢å LIKE '%<%' OR é¡§å®¢å LIKE '%>%' OR é¡§å®¢å LIKE '%"%' THEN 'é¡§å®¢åã«å±é™ºæ–‡å­—'
    WHEN å•†å“å LIKE '%<%' OR å•†å“å LIKE '%>%' OR å•†å“å LIKE '%"%' THEN 'å•†å“åã«å±é™ºæ–‡å­—'
    ELSE 'OK'
  END as special_char_issue
FROM orders
WHERE é¡§å®¢å LIKE '%<%' OR é¡§å®¢å LIKE '%>%' OR é¡§å®¢å LIKE '%"%'
   OR å•†å“å LIKE '%<%' OR å•†å“å LIKE '%>%' OR å•†å“å LIKE '%"%';`,
                    cleanup: `-- ç‰¹æ®Šæ–‡å­—ã®é™¤å»
UPDATE orders
SET 
  é¡§å®¢å = REPLACE(REPLACE(REPLACE(é¡§å®¢å, '<', ''), '>', ''), '"', ''),
  å•†å“å = REPLACE(REPLACE(REPLACE(å•†å“å, '<', ''), '>', ''), '"', '');`
                }
            }
        };

        function replaceTableName(query, tableName, sqlType) {
            if (sqlType === 'bigquery') {
                // BigQueryã®å ´åˆã€ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã‚€
                const tableRef = tableName.includes('.') ? `\`${tableName}\`` : `\`your_project.your_dataset.${tableName}\``;
                return query.replace(/`your_project\.your_dataset\.orders`/g, tableRef);
            } else {
                // SQLiteã®å ´åˆã€ãã®ã¾ã¾ç½®æ›
                return query.replace(/orders/g, tableName);
            }
        }

        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(text).then(function() {
                const originalText = button.textContent;
                button.textContent = 'ã‚³ãƒ”ãƒ¼å®Œäº†!';
                button.classList.add('copied');
                setTimeout(function() {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(function(err) {
                console.error('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ: ', err);
                alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
            });
        }

        function generateSQL() {
            const checkboxes = document.querySelectorAll('.checklist input[type="checkbox"]');
            const sqlType = document.querySelector('input[name="sql_type"]:checked').value;
            const tableName = document.getElementById('tableName').value.trim() || 'orders';
            const resultDiv = document.getElementById('result');
            const sqlOutputDiv = document.getElementById('sqlOutput');
            const generatedQueriesDiv = document.getElementById('generatedQueries');
            
            const selectedChecks = [];
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    selectedChecks.push(checkbox.value);
                }
            });
            
            if (selectedChecks.length === 0) {
                resultDiv.style.display = 'block';
                resultDiv.className = 'result warning';
                resultDiv.innerHTML = 'âš ï¸ ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å®Ÿè¡Œã—ãŸã„å‡¦ç†ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚';
                sqlOutputDiv.style.display = 'none';
                return;
            }
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'result success';
            resultDiv.innerHTML = `âœ… ${selectedChecks.length}å€‹ã®å‡¦ç†ã«å¯¾å¿œã™ã‚‹SQLï¼ˆ${sqlType.toUpperCase()}ï¼‰ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚<br>ãƒ†ãƒ¼ãƒ–ãƒ«å: <strong>${tableName}</strong>`;
            
            let queriesHTML = '';
            selectedChecks.forEach((checkValue, index) => {
                const queryData = sqlQueries[checkValue][sqlType];
                if (queryData) {
                    const detectionQuery = replaceTableName(queryData.detection, tableName, sqlType);
                    const cleanupQuery = replaceTableName(queryData.cleanup, tableName, sqlType);
                    
                    queriesHTML += `
                        <div style="margin-bottom: 30px; border: 1px solid #ddd; padding: 20px; border-radius: 8px;">
                            <h3 style="color: #2c3e50; margin-top: 0;">${queryData.title}</h3>
                            <p style="color: #666; margin-bottom: 15px;">${queryData.description}</p>
                            
                            <div class="query-section">
                                <div class="query-header">
                                    <h4 style="color: #34495e; margin: 0;">ğŸ” å•é¡Œæ¤œå‡ºç”¨ã‚¯ã‚¨ãƒª</h4>
                                    <button class="copy-button" onclick="copyToClipboard(\`${detectionQuery.replace(/`/g, '\\`')}\`, this)">ã‚³ãƒ”ãƒ¼</button>
                                </div>
                                <div class="query-content">
                                    <pre style="background-color: #f8f9fa; padding: 15px; margin: 0; overflow-x: auto; font-size: 14px;"><code>${detectionQuery}</code></pre>
                                </div>
                            </div>
                            
                            <div class="query-section">
                                <div class="query-header">
                                    <h4 style="color: #34495e; margin: 0;">ğŸ”§ ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ç”¨ã‚¯ã‚¨ãƒª</h4>
                                    <button class="copy-button" onclick="copyToClipboard(\`${cleanupQuery.replace(/`/g, '\\`')}\`, this)">ã‚³ãƒ”ãƒ¼</button>
                                </div>
                                <div class="query-content">
                                    <pre style="background-color: #f8f9fa; padding: 15px; margin: 0; overflow-x: auto; font-size: 14px;"><code>${cleanupQuery}</code></pre>
                                </div>
                            </div>
                        </div>
                    `;
                }
            });
            
            generatedQueriesDiv.innerHTML = queriesHTML;
            sqlOutputDiv.style.display = 'block';
            sqlOutputDiv.scrollIntoView({ behavior: 'smooth' });
        }
        
        function resetChecks() {
            const checkboxes = document.querySelectorAll('.checklist input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            
            document.getElementById('result').style.display = 'none';
            document.getElementById('sqlOutput').style.display = 'none';
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ­£è¦åŒ–ãƒ»ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
        });
    </script>
</body>
</html>